name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  lint:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.12'

    - name: Install Poetry
      run: |
        curl -sSL https://install.python-poetry.org | python3 -
        echo "$HOME/.local/bin" >> $GITHUB_PATH

    - name: Install dependencies
      run: |
        poetry install --with dev

    - name: Run pre-commit hooks
      run: |
        poetry run pre-commit run --all-files

  # Comentar tests hasta estabilizar
  # test:
  #   runs-on: ubuntu-latest
  #
  #   steps:
  #   - uses: actions/checkout@v4
  #
  #   - name: Set up Python
  #     uses: actions/setup-python@v5
  #     with:
  #       python-version: '3.12'
  #
  #   - name: Install Poetry
  #     run: |
  #       curl -sSL https://install.python-poetry.org | python3 -
  #       echo "$HOME/.local/bin" >> $GITHUB_PATH
  #
  #   - name: Install dependencies
  #     run: |
  #       poetry install
  #
  #   - name: Run tests
  #     run: |
  #       poetry run pytest -v --cov=app --cov-report=xml
  #
  #   - name: Upload coverage
  #     uses: codecov/codecov-action@v3
  #     with:
  #       file: ./coverage.xml
  #       fail_ci_if_error: false
